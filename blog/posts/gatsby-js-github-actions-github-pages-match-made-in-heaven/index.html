<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.4e22ea58d3d94c6d34fe.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}*{margin:0;padding:0}h1,h2,h3,h4,h5,h6{position:relative;font-family:var(--heading-font);margin:1em 0;font-weight:700}.anchor.before{fill:var(--fg-color)}body{--link-color:#ff5964;--bg-color:#fdfffc;--fg-color:#2b2d42;--base-unit:16px;--dark-text:#141414;--heading-font:"Open Sans","Open Sans","Montserrat",sans-serif;--body-font:"Open Sans",Avenir,Helvetica,Arial,sans-serif;--gray:#90a4ae;--shadow:#d7d7d7 5px 5px 10px;--pagination-background:#fafafa;--pagination-active-background:#f5f5f5;--blur:5px;background-color:var(--bg-color);color:var(--fg-color);font-size:var(--base-unit);font-family:var(--body-font);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;transition:background-color .5s}body.dark{--link-color:#83bcff;--bg-color:#2b2d42;--fg-color:#fdfffc;--gray:#90a4ae;--shadow:#000 5px 5px 10px;--pagination-background:#212121;--pagination-active-background:#424242;--blur:0px}p{line-height:25px;margin-bottom:1.5em}a{color:var(--link-color);font-weight:700;text-decoration:none}li a,p a{background:linear-gradient(180deg,var(--link-color) 0,var(--link-color)) repeat-x 0 100%;background-size:4px 2px;transition:all .3s}li a:hover,p a:hover{background-size:4px 50px;color:var(--fg-color)}ol,ul{margin-bottom:2em;margin-left:5%}ol li:not(:last-child),ul li:not(:last-child){margin-bottom:.5em}blockquote{position:relative;display:block;color:var(--gray);margin-bottom:2rem;padding:.5rem 0 .5rem 5%;font-size:1.5rem;border-left:5px solid var(--link-color)}blockquote p:last-child{padding:0;margin:0}blockquote p{line-height:2rem}.video-container{position:relative;width:100%;height:0;padding-bottom:56.25%;margin-bottom:1.5625rem}.video{position:absolute;top:0;left:0;width:100%;height:100%}code[class*=language-],pre[class*=language-]{font-family:Source Code Pro,monospace}:not(pre)>code[class*=language-]{background:none;color:var(--fg-color)}hr{margin:2em auto;border:none;border-top:3px dotted var(--gray);width:15%}@media screen and (max-width:1024px){body{--base-unit:15px}p{line-height:22px}}@media screen and (max-width:768px){body{--base-unit:14px}p{line-height:20px}blockquote{width:90%;margin:0 auto 2em}}@media screen and (max-width:512px){body{--base-unit:13px}p{line-height:18px}}.Layout-module--layout--2zXLw{margin:3rem auto;max-width:900px}header{display:flex;align-items:center;justify-items:center;justify-content:space-between}header h3{margin:0;padding:0;color:var(--fg-color)}header nav{align-self:end;justify-self:end}header nav a:not(:last-child){margin-right:15px}.Layout-module--title--P-Zzq{align-items:center}.Layout-module--title--P-Zzq,footer>div{display:flex;justify-content:space-between}footer>div{width:100%}.Layout-module--site-description--3McOi{flex-basis:1;min-width:30%}.Layout-module--site-description--3McOi p{margin:0;padding:0}.Layout-module--footer-links--qvJZ7{width:100%;flex-basis:1;display:flex}.Layout-module--footer-title--3f3Cy{font-weight:700;padding:0;margin:0 0 15px}.Layout-module--page-navigation--2zYAc a,.Layout-module--social-media--2xb-L a{display:block;margin-bottom:5px}.Layout-module--page-navigation--2zYAc,.Layout-module--social-media--2xb-L{flex-basis:1;min-width:50%}.Layout-module--page-navigation--2zYAc a,.Layout-module--social-media--2xb-L a{font-weight:400}.Layout-module--social-media--2xb-L a{display:flex;align-items:center}.Layout-module--social-media--2xb-L svg{margin-right:5px;width:1.5em;height:1.5em}@media screen and (max-width:1024px){.Layout-module--layout--2zXLw{max-width:700px}}@media screen and (max-width:768px){.Layout-module--layout--2zXLw{max-width:500px}header{align-items:center;justify-content:center}footer>div,header{flex-direction:column}footer div{margin-bottom:20px}header nav{align-self:center;justify-self:center;margin-top:15px}}@media screen and (max-width:512px){.Layout-module--layout--2zXLw{max-width:420px}}@media screen and (max-width:420px){.Layout-module--layout--2zXLw{max-width:380px}}@media screen and (max-width:380px){.Layout-module--layout--2zXLw{max-width:300px}}.BackToTop-module--arrow--Co3pG{position:fixed;bottom:0;right:0;display:inline-flex;border-radius:3px;padding:5px 15px 15px 5px}.BackToTop-module--arrow--Co3pG:hover{cursor:pointer}.BackToTop-module--hidden--2YJe5{visibility:collapse}@media screen and (max-width:768px){.BackToTop-module--arrow--Co3pG{visibility:collapse}}.index-module--home-container--3gShE{height:100%;margin:3em auto;max-width:1024px}.index-module--main-container--2f8vf{display:flex;justify-content:space-between}.index-module--main-container--2f8vf .index-module--left--2t5Y8{flex-basis:1;width:24%;text-align:right}.index-module--main-container--2f8vf .index-module--left--2t5Y8 img{border-radius:10px;margin-bottom:1em;width:100%}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--name--1vmXB h1,.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--name--1vmXB h2{margin:0;padding:0}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--name--1vmXB h1{font-weight:400}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--name--1vmXB h2{color:var(--gray)}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--links--3i00D{margin-top:1em;margin-bottom:1em}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--links--3i00D a{display:block;font-weight:400}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--links--3i00D a:not(:last-child){margin-bottom:.3em}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--contact--1t6Ht a{display:flex;justify-content:right;align-items:flex-end;flex-direction:row-reverse;font-weight:400}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--contact--1t6Ht a:not(:last-child){margin-bottom:.3em}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--contact--1t6Ht strong,.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--links--3i00D strong{display:block;margin-bottom:1em}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--contact--1t6Ht svg{width:1.5em;height:1.5em;margin-left:.5em}.index-module--main-container--2f8vf .index-module--right--3EWLN h1{margin-top:0}.index-module--main-container--2f8vf .index-module--right--3EWLN{flex-basis:2;width:72%}.index-module--main-container--2f8vf .index-module--right--3EWLN .index-module--recent--Cco9k h1{color:var(--fg-color)}.index-module--main-container--2f8vf .index-module--right--3EWLN .index-module--recent--Cco9k .index-module--subtitle--37c8q{font-weight:400;margin:0 0 .5em}.index-module--main-container--2f8vf .index-module--right--3EWLN .index-module--recent--Cco9k h2{color:var(--gray);margin:0 0 .3em;font-weight:400}.index-module--main-container--2f8vf .index-module--right--3EWLN .index-module--recent--Cco9k .index-module--recent-box--se9ZG:not(:last-child){margin-bottom:2.5em}.index-module--main-container--2f8vf .index-module--right--3EWLN .index-module--recent--Cco9k .index-module--view-all--QEr43{display:block;margin-bottom:1.2em}@media screen and (max-width:1024px){.index-module--home-container--3gShE{max-width:950px}}@media screen and (max-width:950px){.index-module--home-container--3gShE{max-width:768px}.index-module--main-container--2f8vf{flex-direction:column}.index-module--main-container--2f8vf .index-module--left--2t5Y8,.index-module--main-container--2f8vf .index-module--right--3EWLN{width:100%}.index-module--main-container--2f8vf .index-module--left--2t5Y8{text-align:center;margin-bottom:2em}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--contact--1t6Ht a span{display:none}.index-module--main-container--2f8vf .index-module--left--2t5Y8 img{width:20%;height:20%}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--contact--1t6Ht a,.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--links--3i00D a{display:inline-block}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--links--3i00D a:not(:last-child){margin-right:1em}.index-module--main-container--2f8vf .index-module--left--2t5Y8 .index-module--contact--1t6Ht svg{width:3em;height:3em;margin:0 .5em 0 0}}@media screen and (max-width:768px){.index-module--home-container--3gShE{max-width:500px}}@media screen and (max-width:512px){.index-module--home-container--3gShE{max-width:400px}.index-module--contact--1t6Ht,.index-module--links--3i00D{flex-direction:column}.index-module--links--3i00D{margin-bottom:15px}}@media screen and (max-width:420px){.index-module--home-container--3gShE{max-width:300px}}.ThemeToggle-module--theme-toggle--9os16:hover{cursor:pointer}.BlogList-module--general-title--N3FCQ{display:flex;justify-content:space-between;align-items:center}.BlogList-module--blog-card--27dK6 a h2{margin:0;padding:0}.BlogList-module--blog-card--27dK6 a{text-decoration:none}.BlogList-module--subtitle--2LG5g{display:flex;justify-content:space-between}.BlogList-module--subtitle--2LG5g h3{margin:1em 0;color:var(--gray);padding:0}.BlogList-module--tags--10Y2b{display:flex;flex-wrap:wrap}.BlogList-module--tags--10Y2b div{display:flex;padding:5px 10px;background-color:#e0f2f1;border-radius:5px;align-items:center;justify-content:center;margin-bottom:15px}.BlogList-module--tags--10Y2b div span{color:#424242}.BlogList-module--tags--10Y2b div svg{margin-right:5px}.BlogList-module--tags--10Y2b div:not(:last-child){margin-right:10px}.BlogPost-module--subtitle--kxzpS{margin-top:0;color:var(--gray)}.BlogPost-module--tags--eJOlF h4{display:flex;flex-wrap:wrap;margin-bottom:10px}.BlogPost-module--tags--eJOlF h4 svg{margin-right:15px}.BlogPost-module--tags-container--2pTNp{display:flex;flex-wrap:wrap}.BlogPost-module--tags--eJOlF span{padding:5px 10px;background-color:#5bc0be;color:var(--fg-color);border-radius:5px;margin-bottom:10px}.BlogPost-module--tags--eJOlF span:not(:last-child){margin-right:10px}.ProjectList-module--project-title--3kwQL{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.ProjectList-module--project-title--3kwQL h2{margin:0}.ProjectList-module--language--15s10,.ProjectList-module--status--3VKN0{border-radius:3px;padding:5px}.ProjectList-module--language--15s10{background-color:rgba(181,144,202,.4)}span.ProjectList-module--language--15s10{margin-right:15px}.ProjectList-module--description--2r6oZ{margin-bottom:15px}@media screen and (max-width:420px){.ProjectList-module--project-title--3kwQL{flex-direction:column;align-items:start}.ProjectList-module--project-title--3kwQL h2{margin-bottom:15px}}.PostListPagination-module--paginator--CXC0r{margin-top:15px;display:flex;justify-content:center}.PostListPagination-module--active-page--2Iun6{background-color:var(--pagination-active-background)}.PostListPagination-module--paginator--CXC0r div{display:flex;flex-direction:row;align-content:center;align-items:center;justify-content:center}.PostListPagination-module--page-number--1Z7qA{display:inline-flex;padding:3px 10px;border:1px solid #e0e0e0}.PostListPagination-module--page-number--1Z7qA:hover{background-color:var(--pagination-background)}.ProjectListing-module--content--3DCL3 h2,.ProjectListing-module--content--3DCL3 h3{margin-top:0}.ProjectListing-module--links--26fwo{display:flex;flex-direction:column;margin-bottom:15px}.ProjectListing-module--links--26fwo a:not(:last-child){margin-bottom:15px}.ProjectListing-module--content--3DCL3{display:flex;justify-content:space-between}.ProjectListing-module--sidebar--1n511{flex-basis:30%}.ProjectListing-module--main-content--21IJP{flex-basis:60%}@media screen and (max-width:512px){.ProjectListing-module--content--3DCL3{flex-direction:column}}.ImageCarousel-module--carousel-container--3uEUQ{position:relative;box-shadow:var(--shadow);margin-bottom:30px}.ImageCarousel-module--carousel--3uDiR{position:relative}.ImageCarousel-module--background-image--3N-jf{position:absolute;height:500px;top:0;width:100%;overflow:hidden;filter:blur(var(--blur))}.ImageCarousel-module--foreground-image--3FGzg{display:flex;justify-content:center}.ImageCarousel-module--navigation-container--1Ggqi{position:absolute;top:0;bottom:0;left:0;right:0;display:flex;align-items:center;justify-content:center}.ImageCarousel-module--navigation--3yJDh{width:100%;display:flex;justify-content:space-between}.ImageCarousel-module--navigation--3yJDh div{padding:15px}.ImageCarousel-module--navigation--3yJDh div:hover{cursor:pointer}@media screen and (max-width:768px){.ImageCarousel-module--background-image--3N-jf,.ImageCarousel-module--carousel-container--3uEUQ,.ImageCarousel-module--foreground-image--3FGzg,.ImageCarousel-module--foreground-image--3FGzg img{max-height:300px;max-height:200px}}.PostNavigation-module--navigation--2HltI .PostNavigation-module--buttons--3L6xD{display:flex;justify-content:space-between}.PostNavigation-module--navigation--2HltI .PostNavigation-module--buttons--3L6xD p{display:flex;max-width:450px;border-radius:5px;margin-bottom:0}.PostNavigation-module--navigation--2HltI .PostNavigation-module--buttons--3L6xD p a{display:flex;align-items:center;color:var(--textTitle);background:none}@media screen and (max-width:768px){.PostNavigation-module--navigation--2HltI .PostNavigation-module--buttons--3L6xD{flex-direction:column}.PostNavigation-module--navigation--2HltI .PostNavigation-module--buttons--3L6xD p:first-child{margin-bottom:15px;align-self:flex-start}.PostNavigation-module--navigation--2HltI .PostNavigation-module--buttons--3L6xD p:last-child{align-self:flex-end}}.QuickLink-module--link--3Ij_x{display:flex;justify-content:space-between;align-items:center;margin-bottom:1em;padding-left:1em;border-left:5px solid var(--link-color)}.QuickLink-module--link--3Ij_x h1{margin:0 0 .3em}.QuickLink-module--link--3Ij_x p{color:var(--gray);font-weight:400;margin:0;padding:0}.QuickLink-module--link--3Ij_x svg{width:2em;height:2em}</style><meta name="generator" content="Gatsby 2.31.1"/><title data-react-helmet="true">Gatsby.js + GitHub Actions + GitHub Pages = Match Made in Heaven? | A Programmer&#x27;s Perspective</title><meta data-react-helmet="true" name="description" content="14 April 2020 - Gatsby.js + GitHub Actions + GitHub Pages = Match Made in Heaven? - A deep dive into creating a continuous deployment system using Gatsby.js, GitHub Actions, and GitHub Pages"/><meta data-react-helmet="true" name="image" content="https://woojiahao.github.io/images/icon.png"/><meta data-react-helmet="true" property="keywords" content="tutorial, guide, Gatsby.js, GitHub Actions, GitHub Pages, continuous deployment, Javscript, GitHub"/><meta data-react-helmet="true" property="og:url" content="https://woojiahao.github.io/blog/posts/gatsby-js-github-actions-github-pages-match-made-in-heaven"/><meta data-react-helmet="true" property="og:title" content="Gatsby.js + GitHub Actions + GitHub Pages = Match Made in Heaven? | A Programmer&#x27;s Perspective"/><meta data-react-helmet="true" property="og:description" content="14 April 2020 - Gatsby.js + GitHub Actions + GitHub Pages = Match Made in Heaven? - A deep dive into creating a continuous deployment system using Gatsby.js, GitHub Actions, and GitHub Pages"/><meta data-react-helmet="true" property="og:image" content="https://woojiahao.github.io/images/icon.png"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-164563111-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-164563111-1', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans" rel="stylesheet"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="icon" href="/favicon-32x32.png?v=fd6bdb13db7426fe1da41411ded1b516" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=fd6bdb13db7426fe1da41411ded1b516"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=fd6bdb13db7426fe1da41411ded1b516"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=fd6bdb13db7426fe1da41411ded1b516"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=fd6bdb13db7426fe1da41411ded1b516"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=fd6bdb13db7426fe1da41411ded1b516"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=fd6bdb13db7426fe1da41411ded1b516"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=fd6bdb13db7426fe1da41411ded1b516"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=fd6bdb13db7426fe1da41411ded1b516"/><link as="script" rel="preload" href="/webpack-runtime-134079a611878ce48516.js"/><link as="script" rel="preload" href="/framework-2d6b7d2e2be378715b78.js"/><link as="script" rel="preload" href="/app-f2fdf53ce18318d17ea4.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/d0447323-cae2f9eea28153ff109a.js"/><link as="script" rel="preload" href="/d7eeaac4-320b13e4234848d62615.js"/><link as="script" rel="preload" href="/0c428ae2-fb52da31a9a33afc1b40.js"/><link as="script" rel="preload" href="/252f366e-bdbd49a4586cd3b64949.js"/><link as="script" rel="preload" href="/95b64a6e-442b69fb0b15ea4541d4.js"/><link as="script" rel="preload" href="/5e2a4920-45c4ae8f8433c721d319.js"/><link as="script" rel="preload" href="/9f543f25a70c8f21fd0b844d715a43e0aaffa939-5907651d187d8968c824.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-blog-post-js-269f37239ee9aca0093e.js"/><link as="fetch" rel="preload" href="/page-data/blog/posts/gatsby-js-github-actions-github-pages-match-made-in-heaven/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2068778362.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2207116114.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="Layout-module--layout--2zXLw"><label style="position:fixed;right:0;top:0;margin:15px"><input type="checkbox" hidden=""/> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="ThemeToggle-module--theme-toggle--9os16" height="1.25em" width="1.25em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M14.53 10.53a7 7 0 01-9.058-9.058A7.003 7.003 0 008 15a7.002 7.002 0 006.53-4.47z" clip-rule="evenodd"></path></svg></label><header><a href="/"><h3>A Programmer&#x27;s Perspective</h3></a><nav><a href="/blog">Blog</a><a href="/projects">Projects</a><a href="/about">About Me</a><a href="https://www.notion.so/woojiahao/48b21a97d71c4cd2bc9a9051bd7423a3?v=e2c493015ceb47cfa275a03f20895cb1">Recommendations</a></nav></header><div class="Layout-module--title--P-Zzq"><h1>Gatsby.js + GitHub Actions + GitHub Pages = Match Made in Heaven?</h1></div><div style="margin-bottom:2em"><div><h4 class="BlogPost-module--subtitle--kxzpS">Published on: <!-- -->14 April 2020</h4><div><p>After a long hiatus induced by the demons that was school, I have finally defeated the final boss and graduated! </p>
<p>With that, I have started to work on re-building my portfolio site (you're seeing it right now!). I wanted to learn <a href="https://www.gatsbyjs.org/">Gatsby.js</a> and so I figured it would be the best time to do so! While working with Gatsby.js, one of the issues that I had faced was not having a proper guide on deploying Gatsby.js applications onto GitHub Pages via GitHub Actions. The official documentation does include a <a href="https://www.gatsbyjs.org/docs/how-gatsby-works-with-github-pages/">guide</a> on perform <a href="https://www.atlassian.com/continuous-delivery/continuous-deployment">Continuous Deployment (CD)</a> via <a href="https://travis-ci.org/">Travis.CI</a> but I wanted to mess around with <a href="https://github.com/features/actions">GitHub Actions</a> - GitHub's own CI/CD pipeline.</p>
<p>So I decided to experiment with building my own workflow and document my process. It was quite interesting how I got to the current refinement of my CD workflow and I will be sharing a little on the mistakes that I had made and the lessons learnt.</p>
<h2 id="why-gatsbyjs" style="position:relative;"><a href="#why-gatsbyjs" aria-label="why gatsbyjs permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why Gatsby.js?</h2>
<p>Taken directly from Gatsby's web description...</p>
<blockquote>
<p>Gatsby.js is a PWA (Progressive Web App) generator.</p>
</blockquote>
<p>It may seem a little odd at first but basically, Gatsby.js is a static site generator built around React. It ties together various React plugins - like <code class="language-text">react-router</code> and <code class="language-text">webpack</code> - to create a seamless development experience when creating static sites.</p>
<p>A static site is a site where a framework is used but the library generates the resulting HTML/CSS/JS files. In doing so, the site is far more performant than dynamic sites that take time to execute the code of the framework. Gatsby.js performs all the execution when creating a bundle and we simply deploy this bundle to GitHub pages or any web hosting platform to have our site up and running. </p>
<p>In a future post, I will be covering the merits of a static site generator - specifically Gatsby.js - but for now, let's move on to our next tool, <strong>GitHub Pages!</strong></p>
<h2 id="why-github-pages" style="position:relative;"><a href="#why-github-pages" aria-label="why github pages permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why GitHub Pages?</h2>
<p>GitHub pages is...</p>
<blockquote>
<p>GitHub Pages is a static site hosting service that takes HTML, CSS, and JavaScript files straight from a repository on GitHub, optionally runs the files through a build process, and publishes a website.</p>
</blockquote>
<p>(Definition taken from <a href="https://help.github.com/en/github/working-with-github-pages/about-github-pages">here</a>)</p>
<p>I would like to focus on these four hyper-critical words: "static site hosting service". Recall when I mentioned that Gatsby.js is a static site generator? These four words are like music to my ears! It means that once we have generated that bundle with Gatsby.js, we can use GitHub Pages to host our website! </p>
<p>This is awesome because I needed a cheap (if not nothing) hosting provider to host my portfolio website. GitHub Pages will deploy the site directly from a GitHub repository, providing seamless integration and it is super userful for creating documentation sites for your projects!</p>
<p>A big perk to using GitHub Pages is that you can have a <strong>user page</strong>. This is created from a repository that follows this naming pattern: <code class="language-text">&lt;GitHub username&gt;.github.io</code>. When using a user page, you will receive access to the <code class="language-text">.github.io</code> domain. This is useful for portfolio sites as it now means that we are able to deploy our portfolio page and have a domain name like <code class="language-text">woojiahao.github.io</code>! </p>
<p>You can find out more about GitHub pages <a href="https://help.github.com/en/github/working-with-github-pages/about-github-pages">here</a> and more about user pages <a href="https://help.github.com/en/github/working-with-github-pages/about-github-pages#types-of-github-pages-sites">here.</a></p>
<h2 id="why-github-actions" style="position:relative;"><a href="#why-github-actions" aria-label="why github actions permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why GitHub Actions?</h2>
<p>Finally, we have the star of the evening - <strong>GitHub Actions!</strong></p>
<blockquote>
<p>GitHub Actions makes it easy to automate all your software workflows, now with world-class CI/CD. Build, test, and deploy your code right from GitHub.</p>
</blockquote>
<p>(Definition taken from <a href="https://github.com/features/actions">here</a>)</p>
<p>GitHub Actions allows us to develop CI/CD workflows that integrates directly with GitHub. For our use case, we can use the default tier. </p>
<p>I picked GitHub Actions primarily because I was intrigued by it and wanted to give it a spin. I had adopted it when working on <a href="/projects/posts/torrent.go"><strong>torrent.go</strong></a> (a BitTorrent protocol implementation written with Go!) and found that it was rather unique in its approach so I wanted to test it out even more.</p>
<h2 id="chief-what-is-our-plan-of-attack" style="position:relative;"><a href="#chief-what-is-our-plan-of-attack" aria-label="chief what is our plan of attack permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Chief! What is our plan of attack?</h2>
<p>First, I would like to discuss the final strategy that I took to deploy my portfolio site to GitHub pages.</p>
<p>To begin, we need to outline the strict limitation of user sites...</p>
<blockquote>
<p>If the repository for your user or organization site has a master branch, your site will publish automatically from that branch. You cannot choose a different publishing source for user or organization sites.</p>
</blockquote>
<p>This means that for our site, if we are using <code class="language-text">woojiahao.github.io</code>, we MUST publish the site to the <code class="language-text">master</code> branch.</p>
<p>Our CD workflow looks a little like this:</p>
<ol>
<li>
<p>We push our latest changes in Gatsby.js (including new blog posts, project listings, or just site changes) to a <code class="language-text">develop</code> branch</p>
<p>As we may have multiple sets of changes that we push at different times, we do not want our site to be deployed immediately. Instead, we move on to step dos!</p>
</li>
<li>We will merge the changes into a <code class="language-text">publish</code> branch. On merge, we should automatically deploy our application.</li>
<li>Now this is where it gets tricky, we need to build our Gatsby.js page - to create the bundle - and set the contents of this bundle to the contents of the <code class="language-text">master</code> branch.</li>
</ol>
<p>  This is where you can see our consideration of the limitation mentioned above take effect. However, by setting the <code class="language-text">master</code> branch to be a "dump" for the bundle files, it would be hard for us to navigate our GitHub repository. This is why we need to properly setup our branches to allow for this peculiar workflow!</p>
<h2 id="go-go-go" style="position:relative;"><a href="#go-go-go" aria-label="go go go permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Go, go, go!</h2>
<p>Let's dive right into the configurations.</p>
<h3 id="setting-up-branching" style="position:relative;"><a href="#setting-up-branching" aria-label="setting up branching permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting up branching</h3>
<p>The first order of business is to properly setup our branching strategy. We will use a mix of both the GitHub UI and the Git CLI. So if you have not installed the Git CLI, you can do so <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">here.</a></p>
<p>As mentioned in our workflow, we will be using three branches:</p>
<ul>
<li><code class="language-text">master</code> - to hold the build bundle and renders the page</li>
<li><code class="language-text">develop</code> - pseudo-master branch that we will use to host our changes in Gatsby.js</li>
<li><code class="language-text">publish</code> - merge-only branch that we use to trigger a deployment</li>
</ul>
<p>So, let's first create and push the other two branches.</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">git</span> checkout -b develop
$ <span class="token function">git</span> checkout -b publish
$ <span class="token function">git</span> push -u origin develop
$ <span class="token function">git</span> push origin publish</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>So we checkout the <code class="language-text">develop</code> branch before the <code class="language-text">publish</code> branch since we want the <code class="language-text">publish</code> branch to be based on the latest changes of the <code class="language-text">develop</code> branch. Don't worry, however, we will only be needing to checkout the <code class="language-text">publish</code> branch via the Git CLI only once to configure.</p>
<p>We push and set the <code class="language-text">develop</code> branch to be our <a href="https://stackoverflow.com/questions/4693588/what-is-a-tracking-branch">tracking branch</a> as from now on, we want to permanently push to the remote <code class="language-text">develop</code> branch.</p>
<p>We also push the <code class="language-text">publish</code> branch to create the remote branch.</p>
<p>If you go to the repository in GitHub and expand the "Branch" dropdown, you should see that there will be three branches now.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 333px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1d898b368ad862ca9f36e76284c27b35/24c7e/remote-branches.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 84%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACJ0lEQVQ4y42TiY7TMBRF8ylMk3hf4sRJumRXV6bTlhEgAf//H1y3o6GiCIiOomfHz8/P9yZyRblq+3qxXLbdtN5udvtxnApfESaWTTNO06rpxmnshmGYxn7ouZSE8RtR7stuGJdNu2q7j8fT8XTZHw5lVVMu2354Pr5s94ftbrs7HE6XMwKhNOUChGShjFBWaqtMxoSiXHFpEGvrGFcp5SkVNxKCaiKsl4YLrYyLhFTn88vXL5+Px+fL+RS4nF9fP/34/m25WDLKpJDi7UEgOReAMW5CsimYrbmdM1PzbMEQ2DnP5uIa0zA5fwQpJp9H1K9VOYqi5UXL8kb4LgRuhZlbnJjFI7Fe8HoXiXo7r733Ls8zl5m6zH3hMqurqqjKwjnLGCEk/Y00TVi1iahrZ7Z/0s2TafFOsj7O+pntPqhVbDsMUzc8kmSD8GPEpYZa02bTD1M/TspY3GRVL6C2VAZfMfyF1LjtMC+0sS7iV918VRuc2uUJZfiQuWLVtFJZqHIPkhPC4pRBQuOKCFrDEkhr2g74skoITSmdJSlBu3dgkku1P+xfTsembbBRBGO4wmubwaGgKIMxmZBXw8h7CCRXuulgyMmXtdRZSI4JxWrkAxzk5r4/QriYJeQpTuOUwIURtkxhI236Yeh6+B6WZO/WfwRboBK6ENqG20bxN+QV8W9C9zZHZYEzaGt3+916vYYC1wtjfwdrQmX0Gn4UvLW9yfifoOefr5C+dANGXCwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="GitHub remote branches"
        title="GitHub remote branches"
        src="/static/1d898b368ad862ca9f36e76284c27b35/24c7e/remote-branches.png"
        srcset="/static/1d898b368ad862ca9f36e76284c27b35/3684f/remote-branches.png 225w,
/static/1d898b368ad862ca9f36e76284c27b35/24c7e/remote-branches.png 333w"
        sizes="(max-width: 333px) 100vw, 333px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Once done, we can now continue our branching configurations in the GitHub UI.</p>
<p>Under "Settings > Branches", there is an option for the "Default branch". Normally, it is the <code class="language-text">master</code> branch. However, as mentioned earlier, we want to be able to view and access our repository easily (and have the all-so-important language colors be right!). So, we will change the default branch to be <code class="language-text">develop</code>.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 900px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/aef20a3af94b6a331fae5554dd438b30/b6e34/default-branch.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 23.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAwklEQVQY002OC46DMAxEc5hC/Ms/0EJKiuj971Rnq12t9GTZY9kzxvvgQ/QhiAspFxEnzqsYYkopa59yds6PXUpXW0v0FhCQFEMuIDGJs8gx121v98emIDOyWCStgN+eLcuMNAP+QAbzBhJ1mIDY+bqueVlSqchOhXFJDDwgEfX4Q3VT7rtF0TeTRc12vd/P3s/r6ufZjuPo/an19VLqskbNXkquVVEn4+rDAo1IOJz31mLKW2vfzP+5WbjN9heYLHwAfIo2jRuGmDwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="GitHub changing default branches"
        title="GitHub changing default branches"
        src="/static/aef20a3af94b6a331fae5554dd438b30/1cfc2/default-branch.png"
        srcset="/static/aef20a3af94b6a331fae5554dd438b30/3684f/default-branch.png 225w,
/static/aef20a3af94b6a331fae5554dd438b30/fc2a6/default-branch.png 450w,
/static/aef20a3af94b6a331fae5554dd438b30/1cfc2/default-branch.png 900w,
/static/aef20a3af94b6a331fae5554dd438b30/b6e34/default-branch.png 1103w"
        sizes="(max-width: 900px) 100vw, 900px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Once we have configured these two aspects, we are done with our branching strategy! Let's move on to the real meat of this CD - the workflow!</p>
<h3 id="creating-the-workflow" style="position:relative;"><a href="#creating-the-workflow" aria-label="creating the workflow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating the workflow</h3>
<p>GitHub Actions will look out for <strong>workflows</strong> in our repository to determine what actions are to be run. These workflows are stored in the <code class="language-text">.github/workflows</code> folder.</p>
<p>We can just name our CD workflow as <code class="language-text">deploy.yml</code>. Yes, these workflow files are declared as YAML documents - like Docker Compose!</p>
<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">/
|_.github/
  |_workflows/
    |_deploy.yml</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>Then, we can start to configure our workflow. Fire up your favourite text editor and let's begin!</p>
<p>The first thing we will configure is when this workflow will run. As mentioned earlier, we want to deploy our site only when we push to the <code class="language-text">publish</code> branch via a merge, thus, we will have the following:</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml"><span class="token key atrule">on</span><span class="token punctuation">:</span> 
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> publish</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>Then, we can start declaring our jobs aka the thing that runs. GitHub Actions allows us to configure concurrent jobs or jobs that rely on one another, but I will not be going into detail about those in this post. If you want more information, please refer to the documentation <a href="https://help.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobs">here.</a> </p>
<p>This workflow will only require one job and we can call it <code class="language-text">deploy</code>. </p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml"><span class="token key atrule">jobs</span><span class="token punctuation">:</span> 
  deploy<span class="token punctuation">:</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>We then specify what is the underlying OS the CD will use to execute this workflow.</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml">    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Then we declare strategies. From my understanding, these are variables that we can use and we can declare them as arrays to allow us to execute the workflow on multiple versions of Node for instance.</p>
<p>However, in our case, we can make do with just having one version of Node since we are building once. If you require more details about strategies in GitHub Actions, refer <a href="https://help.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobsjob_idstrategy">here.</a></p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml">    <span class="token key atrule">strategy</span><span class="token punctuation">:</span>
      <span class="token key atrule">matrix</span><span class="token punctuation">:</span>
        <span class="token key atrule">node_version</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>13.x<span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>Finally, we can declare our steps for the workflow.</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml">    steps<span class="token punctuation">:</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>First, checkout the repository so that our workflow can access it.</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">...</span>
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v1</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Then, we setup Node in out Ubuntu machine. We use the <code class="language-text">node_version</code> we declared in our strategy.</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">...</span>
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">node-version</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.node_version <span class="token punctuation">}</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>Then, we install <code class="language-text">gatsby-cli</code> and the necessary dependencies for our static site to be generated.</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">...</span>
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install <span class="token punctuation">-</span>g gatsby<span class="token punctuation">-</span>cli <span class="token important">&amp;&amp;</span> npm install <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>optional</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Then, we set the Git credentials as we are using the <code class="language-text">gh-pages</code> npm package to deploy our site. I will explain further later on.</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">...</span>
        <span class="token key atrule">run</span><span class="token punctuation">:</span> git config <span class="token punctuation">-</span><span class="token punctuation">-</span>global user.email "&lt;insert GitHub email" <span class="token important">&amp;&amp;</span> git config <span class="token punctuation">-</span><span class="token punctuation">-</span>global user.name "&lt;insert desired name<span class="token punctuation">></span>"</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Lastly, we can build the site bundle and deploy it. I have used a custom script declared in the <code class="language-text">package.json</code> and a GitHub token, both of which I will be discussing below.</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">...</span>
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run deploy
        <span class="token key atrule">env</span><span class="token punctuation">:</span> <span class="token key atrule">GH_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GH_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>There it is. We have created the workflow for deploying our application. However, we have some missing components that we have yet to configure so buckle up for our last set of configurations.</p>
<p>A sample of the whole workflow file looks like this:</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml"><span class="token key atrule">on</span><span class="token punctuation">:</span> 
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> publish

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy website to Github Pages with Gatsby
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">strategy</span><span class="token punctuation">:</span> 
      <span class="token key atrule">matrix</span><span class="token punctuation">:</span>
        <span class="token key atrule">node_version</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>13.x<span class="token punctuation">]</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v1

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Setup Node.js version $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.node_version <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">node-version</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.node_version <span class="token punctuation">}</span><span class="token punctuation">}</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Installing Gatsby CLI
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install <span class="token punctuation">-</span>g gatsby<span class="token punctuation">-</span>cli <span class="token important">&amp;&amp;</span> npm install <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>optional

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Setting Git credentials
        <span class="token key atrule">run</span><span class="token punctuation">:</span> git config <span class="token punctuation">-</span><span class="token punctuation">-</span>global user.email "woojiahao1234@gmail.com" <span class="token important">&amp;&amp;</span> git config <span class="token punctuation">-</span><span class="token punctuation">-</span>global user.name "woojiahao"

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy the site
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run deploy
        <span class="token key atrule">env</span><span class="token punctuation">:</span> 
          <span class="token key atrule">GH_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GH_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h3 id="creating-a-deploy-script" style="position:relative;"><a href="#creating-a-deploy-script" aria-label="creating a deploy script permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating a deploy script</h3>
<p>We are using the <code class="language-text">gh-pages</code> to automatically push the build bundle to the <code class="language-text">master</code> branch. We will need to setup a <code class="language-text">deploy</code> script in our <code class="language-text">package.json</code> to use this package. This script will build the bundle and deploy it to the <code class="language-text">master</code> branch.</p>
<div class="gatsby-highlight" data-language="json"><pre style="counter-reset: linenumber NaN" class="language-json line-numbers"><code class="language-json">  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    ...<span class="token punctuation">,</span>
    <span class="token property">"deploy"</span><span class="token operator">:</span> <span class="token string">"gatsby build &amp;&amp; gh-pages -d public -b master -r https://$GH_TOKEN@github.com/woojiahao/woojiahao.github.io.git"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>I would like to focus in on the command for <code class="language-text">gh-pages</code>.</p>
<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">gh-pages -d public -b master -r ...</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p><code class="language-text">-d</code> indicates which folder the build bundle is located. In Gatsby.js case, it is the <code class="language-text">public/</code> folder.</p>
<p><code class="language-text">-b</code> indicates which branch we will push the build bundle to. By default, it is the <code class="language-text">gh-pages</code> branch. But as I have explained, we need it to be the <code class="language-text">master</code> branch.</p>
<p><code class="language-text">-r</code> indicates the GitHub repsitory we will be pushing too. This uses the <code class="language-text">GH_TOKEN</code> environment variable that we have loaded into the workflow. It also leads us nicely to the next and final configuration we need to perform - getting a GitHub access token.</p>
<h3 id="shhh--access-tokens-and-secrets" style="position:relative;"><a href="#shhh--access-tokens-and-secrets" aria-label="shhh  access tokens and secrets permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Shhh! ... (Access tokens and secrets)</h3>
<p>The last ingredient to this workflow recipe is a GitHub access token.</p>
<p>We can generate a personal access token under "Settings > Developer settings > Personal access tokens > Generate new token". </p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 900px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3ea1db94d0f2eda55742021ae75f6a1d/99661/access-token-location.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 20.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAn0lEQVQI1z2PAY5DIQhE/2FaRRFBATXtpvc/1tI2u+RlMiGTSeaCrn2ar2XuBfGW8i3BPUOYey651AT/lL8/fLmABNjSOxRRHOq+j/oKReJPUUlfoBDLOmeojc7BRXPxebUuFSlXVDVzW58bU2VoKA0rbFENFWujgq3Ut7804ufha8vU6Ma5ab/If5o/STeLxBaIXmwxobOwjB5Q741+Ad22KqsLcCujAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="GitHub access token settings location"
        title="GitHub access token settings location"
        src="/static/3ea1db94d0f2eda55742021ae75f6a1d/1cfc2/access-token-location.png"
        srcset="/static/3ea1db94d0f2eda55742021ae75f6a1d/3684f/access-token-location.png 225w,
/static/3ea1db94d0f2eda55742021ae75f6a1d/fc2a6/access-token-location.png 450w,
/static/3ea1db94d0f2eda55742021ae75f6a1d/1cfc2/access-token-location.png 900w,
/static/3ea1db94d0f2eda55742021ae75f6a1d/99661/access-token-location.png 1098w"
        sizes="(max-width: 900px) 100vw, 900px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>When generating the token, restrict the token's scope to <code class="language-text">repo</code> only. </p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 834px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/dcccc63c1b15c03cb402588462924199/5d72a/create-token.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABsUlEQVQoz21Ra2vUQBTN/7DUJrubeeU1ec1MkklWrX4QZKFLt9paFME/4Qe/+RcEcYVWUdpFW1DwAf44T7JipS2cDHMn95x77r1OmheF1rnShdJ5URZKlQMo54QxyhhZg3MqBOUXIIw7ILRd19i2tq3tOtNOy/ZOaW/rbruabptbd/v79F5uGugWpcpLSKOYYiJwEIdRvBbjQvg88GjgEQ64hOEcUU5CifcJIRNC/8GnzHnx8tWHk6+vlx+X7z8vj1dvj05Pvnxfnf9anf88Pftx9u33m3effKQSCp9/W2AczJ58/8HsybPn+4dP54v92c5iNt+b7x3sPnw84GDx6HC2s+tTOoBdgiPTDF2kWeZ6I28EjF3P23TdjS1vY8u9cdPd9MYkiHwmriFjALW1WVHmZQ+MoGpqZepYNYm2ibEiNyLVNIgIZYPzCzgyy5WpYikRjCY+9CCBVRmj0zRNZEJgmJCrtnsyZRzF225a24YHIWautDZVjQ8qY58Mqfyq556MdcFq3VgUxwJA7stWldIGfPxdb+V6MrJFFCdpSkWAJ4RhnERShonECS+X+vwffwB4cYuxVWTdSwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="GitHub create token"
        title="GitHub create token"
        src="/static/dcccc63c1b15c03cb402588462924199/5d72a/create-token.png"
        srcset="/static/dcccc63c1b15c03cb402588462924199/3684f/create-token.png 225w,
/static/dcccc63c1b15c03cb402588462924199/fc2a6/create-token.png 450w,
/static/dcccc63c1b15c03cb402588462924199/5d72a/create-token.png 834w"
        sizes="(max-width: 834px) 100vw, 834px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>You will receive a token once you create it. Copy this token to your clipboard and save it somewhere secure.</p>
<p>Then, go to the Gatsby.js repository and under "Settings > Secrets", select "Add a new secret". The name of the secret must be <code class="language-text">GH_TOKEN</code> and the value is the copied token.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 900px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/eb2bc7b2a74edbd2a5804a25ba296441/25260/add-secret.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFUlEQVQoz4VQ2U4DMQzcj9mNHTv3tS2Utmz7/9+EkxTBE0gja3yMZc/ivHc+WOeNtSlnNkZSH0KI0fe6E9ZjzG8tXVoiItCEAwtZr9mQcZo55lxbEzUyk7FSR2Ka0VgkA2QUaoHooYvLOxg/SyKr+0nmFNJsi2wSqQifkKWgWeYXym9jH61K57Yfz+f1dr/e75/H8XG7HY/H8XgKkXw/n+WwWGoqRRMrwIXr5Xu3tiGUuqdSs6C1F6mTtBCTdgls2kCv/dJ5NtupB3k1WkV63WBVuAJugJNIFI1CFMhkdUG8WLhd5QEYT6JxXE6U9p91HfyLv0DUXVxMvehQVTdgzg1LR/oHtnl2KA3IDlk3UGzoGOb/iy8wAl27F1cveQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="GitHub add secret"
        title="GitHub add secret"
        src="/static/eb2bc7b2a74edbd2a5804a25ba296441/1cfc2/add-secret.png"
        srcset="/static/eb2bc7b2a74edbd2a5804a25ba296441/3684f/add-secret.png 225w,
/static/eb2bc7b2a74edbd2a5804a25ba296441/fc2a6/add-secret.png 450w,
/static/eb2bc7b2a74edbd2a5804a25ba296441/1cfc2/add-secret.png 900w,
/static/eb2bc7b2a74edbd2a5804a25ba296441/25260/add-secret.png 1113w"
        sizes="(max-width: 900px) 100vw, 900px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>For more information about personal access tokens and GitHub secrets in GitHub Actions, you can check these links out: <a href="Ben2020#2762">access tokens</a> and <a href="https://help.github.com/en/actions/configuring-and-managing-workflows/using-variables-and-secrets-in-a-workflow">secrets.</a></p>
<p>And we are done! This was all the configuration we needed to get the CD workflow working!</p>
<h3 id="it-works" style="position:relative;"><a href="#it-works" aria-label="it works permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IT WORKS!!</h3>
<p>We can test whether the workflow works by making a merge request from <code class="language-text">develop</code> to <code class="language-text">publish</code>. When we accept the merge request, it will push the changes to the <code class="language-text">publish</code> branch and in turn, trigger the workflow and deploy our site.</p>
<p>Now, just sit back and enjoy as the deployment happens automatically.</p>
<h2 id="mistakes-were-made" style="position:relative;"><a href="#mistakes-were-made" aria-label="mistakes were made permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mistakes were made...</h2>
<p>While experimenting with GitHub Actions, I had several "duh" moments.</p>
<h3 id="yaml-disaster" style="position:relative;"><a href="#yaml-disaster" aria-label="yaml disaster permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>YAML disaster</h3>
<p>When I was writing the first iteration of the workflow file, I failed to read the documentation for GitHub secrets and had incorrectly set the environment variable.</p>
<p>FYI, environment variables should be declared like this</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml"><span class="token key atrule">env</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">&lt;key></span><span class="token punctuation">:</span> &lt;value<span class="token punctuation">></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>and not like this</p>
<div class="gatsby-highlight" data-language="yaml"><pre style="counter-reset: linenumber NaN" class="language-yaml line-numbers"><code class="language-yaml"><span class="token key atrule">env</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GH_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Because I had declared it improperly, I was not able to access the <code class="language-text">GH_TOKEN</code> token in my workflow and it caused the workflow to fail. It took me a while to realise what I had done.</p>
<h3 id="repository-takeover" style="position:relative;"><a href="#repository-takeover" aria-label="repository takeover permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Repository takeover!</h3>
<p>When I was first designing my workflow, I had actually completely forgotten that there were branches outside of <code class="language-text">developer</code> and <code class="language-text">master</code>. Originally, I had created a completely separate repository to house my development code. This left the original repository to be a hosting platform for the build bundle.</p>
<p>It took me a while to realise how impractical and unnecessary this was and I re-designed the workflow.</p>
<h2 id="conclusion" style="position:relative;"><a href="#conclusion" aria-label="conclusion permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2>
<p>Overall, this was an interesting journey! I learnt a fair bit about Gatsby.js and GitHub Actions along the way. If you wish to view the Gatsby.js project I use for my portfolio site, you can visit it <a href="https://github.com/woojiahao/woojiahao.github.io">here</a></p></div></div><div class="PostNavigation-module--navigation--2HltI"><hr/><div class="PostNavigation-module--buttons--3L6xD"><p><a href="/blog/posts/deploying-a-discord-bot-written-with-kotlin-on-heroku"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" style="margin-right:15px" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z"></path></svg>Deploying discord bots written in Kotlin to Heroku</a></p><p><a href="/blog/posts/lessons-from-meetup">Lessons from Meetup (and Docker)<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" style="margin-left:15px" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M294.1 256L167 129c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.3 34 0L345 239c9.1 9.1 9.3 23.7.7 33.1L201.1 417c-4.7 4.7-10.9 7-17 7s-12.3-2.3-17-7c-9.4-9.4-9.4-24.6 0-33.9l127-127.1z"></path></svg></a></p></div></div></div><footer><div><div class="Layout-module--site-description--3McOi"><p class="Layout-module--footer-title--3f3Cy">A Programmer&#x27;s Perspective</p><br/><p>Trekking down the path of programming and discussing my encounters with the unknown!</p><br/><p>Copyright  2020-2021. Code <a href="https://github.com/woojiahao/woojiahao.github.io">here.</a></p></div><div class="Layout-module--footer-links--qvJZ7"><div class="Layout-module--page-navigation--2zYAc"><p class="Layout-module--footer-title--3f3Cy">Navigation</p><a href="/">Home</a><a href="/blog">Blog</a><a href="/projects">Projects</a><a href="/about">About Me</a><a href="https://www.notion.so/woojiahao/48b21a97d71c4cd2bc9a9051bd7423a3?v=e2c493015ceb47cfa275a03f20895cb1">Recommendations</a></div><div class="Layout-module--social-media--2xb-L"><p class="Layout-module--footer-title--3f3Cy">Connect with me!</p><a target="_blank" href="https://github.com/woojiahao"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg>woojiahao</a><a target="_blank" href="https://discord.gg/programming"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg>@Chill#4048</a><a target="_blank" href="https://www.linkedin.com/in/jia-hao-woo-089346155/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM349.3 793.7H230.6V411.9h118.7v381.8zm-59.3-434a68.8 68.8 0 1 1 68.8-68.8c-.1 38-30.9 68.8-68.8 68.8zm503.7 434H675.1V608c0-44.3-.8-101.2-61.7-101.2-61.7 0-71.2 48.2-71.2 98v188.9H423.7V411.9h113.8v52.2h1.6c15.8-30 54.5-61.7 112.3-61.7 120.2 0 142.3 79.1 142.3 181.9v209.4z"></path></svg>Woo Jia Hao</a><a target="_blank" href="https://twitter.com/woojiahao_"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM727.3 401.7c.3 4.7.3 9.6.3 14.4 0 146.8-111.8 315.9-316.1 315.9-63 0-121.4-18.3-170.6-49.8 9 1 17.6 1.4 26.8 1.4 52 0 99.8-17.6 137.9-47.4-48.8-1-89.8-33-103.8-77 17.1 2.5 32.5 2.5 50.1-2a111 111 0 0 1-88.9-109v-1.4c14.7 8.3 32 13.4 50.1 14.1a111.13 111.13 0 0 1-49.5-92.4c0-20.7 5.4-39.6 15.1-56a315.28 315.28 0 0 0 229 116.1C492 353.1 548.4 292 616.2 292c32 0 60.8 13.4 81.1 35 25.1-4.7 49.1-14.1 70.5-26.7-8.3 25.7-25.7 47.4-48.8 61.1 22.4-2.4 44-8.6 64-17.3-15.1 22.2-34 41.9-55.7 57.6z"></path></svg>@woojiahao_</a><a target="_blank" href="mailto: woojiahao1234@gmail.com"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg>woojiahao1234@gmail.com</a></div></div></div></footer></div><div class="BackToTop-module--hidden--2YJe5 BackToTop-module--arrow--Co3pG"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1.75em" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M868 545.5L536.1 163a31.96 31.96 0 0 0-48.3 0L156 545.5a7.97 7.97 0 0 0 6 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"></path></svg></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/posts/gatsby-js-github-actions-github-pages-match-made-in-heaven";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-0f9e7d7b54aaab6b0844.js"],"app":["/app-f2fdf53ce18318d17ea4.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-780d0321bb4481125aff.js"],"component---src-pages-404-js":["/component---src-pages-404-js-530c96730a78c33a1371.js"],"component---src-pages-index-js":["/component---src-pages-index-js-ca26822bd4be3c74dd3d.js"],"component---src-templates-blog-list-blog-list-js":["/component---src-templates-blog-list-blog-list-js-a9fb4412a546e91a7449.js"],"component---src-templates-blog-post-blog-post-js":["/component---src-templates-blog-post-blog-post-js-269f37239ee9aca0093e.js"],"component---src-templates-general-post-js":["/component---src-templates-general-post-js-ecb703db951276361854.js"],"component---src-templates-project-list-project-list-js":["/component---src-templates-project-list-project-list-js-c06f97afbde8121cf897.js"],"component---src-templates-project-listing-project-listing-js":["/component---src-templates-project-listing-project-listing-js-1157c092d2b2ec7dcf47.js"],"component---src-templates-redirect-page-js":["/component---src-templates-redirect-page-js-ef06ac09cec434229a7f.js"]};/*]]>*/</script><script src="/polyfill-0f9e7d7b54aaab6b0844.js" nomodule=""></script><script src="/component---src-templates-blog-post-blog-post-js-269f37239ee9aca0093e.js" async=""></script><script src="/9f543f25a70c8f21fd0b844d715a43e0aaffa939-5907651d187d8968c824.js" async=""></script><script src="/5e2a4920-45c4ae8f8433c721d319.js" async=""></script><script src="/95b64a6e-442b69fb0b15ea4541d4.js" async=""></script><script src="/252f366e-bdbd49a4586cd3b64949.js" async=""></script><script src="/0c428ae2-fb52da31a9a33afc1b40.js" async=""></script><script src="/d7eeaac4-320b13e4234848d62615.js" async=""></script><script src="/d0447323-cae2f9eea28153ff109a.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-f2fdf53ce18318d17ea4.js" async=""></script><script src="/framework-2d6b7d2e2be378715b78.js" async=""></script><script src="/webpack-runtime-134079a611878ce48516.js" async=""></script></body></html>