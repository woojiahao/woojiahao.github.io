{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/posts/2018-06-20-Learning-About-KML","result":{"data":{"markdownRemark":{"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>During my second year, I took a data science course and in there, we were instructed to take data sets from <a href=\"https://data.gov.sg\">https://data.gov.sg</a> about housing and provide analysis on the data and present our findings at the end of the assignment. Whilst looking through the data sets, I found that some files were in this mysterious file format: <code class=\"language-text\">.kml</code> and that piqued my interest. So as I did more research, I began to learn more about KML and even took the time out to try to make a <a href=\"https://github.com/woojiahao/KMLConversionTool\">KML to CSV file conversion tool</a>.</p>\n<h2 id=\"what-is-kml\" style=\"position:relative;\"><a href=\"#what-is-kml\" aria-label=\"what is kml permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is KML?</h2>\n<p>KML was originally developed to be used with Google Earth and its purpose was to create a format to display geographic data. This is why, all KML files that I had opened had these odd syntax of specifying coordinates like so:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-xml line-numbers\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearRing</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>coordinates</span><span class=\"token punctuation\">></span></span>103.690974939056,1.34272948662249,0.0 103.690974834354,1.34453820996955,0.0 103.692771950895,1.34453831475346,0.0 103.692772054276,1.34272959126538,0.0 103.690974939056,1.34272948662249,0.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>coordinates</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearRing</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>However, the cool thing about KML is that, since it is an extension of the XML markup, it can also be used to store other data, that is assigned to each of these coordinates which will all be placed into a parent tag called the <code class=\"language-text\">&lt;Placemark&gt;&lt;/Placemark&gt;</code> tag. This tag would store all of the information for a single point or points on the map, including the coordinates and as some might expect, some place specific data.</p>\n<p>The test data I had decided to use was from: <a href=\"https://data.gov.sg/dataset/dengue-cases\">https://data.gov.sg/dataset/dengue-cases</a></p>\n<h2 id=\"making-the-converter\" style=\"position:relative;\"><a href=\"#making-the-converter\" aria-label=\"making the converter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Making the converter</h2>\n<p>So the first thing I had to do before starting to code was to perform some analysis on the .kml format to identify how I would be extracting the column names and the inidividual values from each of the placemarks and then placing them into the .csv file together with the headers.</p>\n<h3 id=\"analysis\" style=\"position:relative;\"><a href=\"#analysis\" aria-label=\"analysis permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Analysis</h3>\n<p>Scrolling through the sample KML files, I found that for each of the extra data placed into the <code class=\"language-text\">Placemark</code> tag, it would have a <code class=\"language-text\">&lt;SimpleData&gt;&lt;/SimpleData&gt;</code> tag associated with each \"row\". For instance, using the <code class=\"language-text\">dengue-cases-south-west-kml.kml</code> file, I found that:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-xml line-numbers\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Placemark</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>kml_1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ExtendedData</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SchemaData</span> <span class=\"token attr-name\">schemaUrl</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#kml_schema_ft_DENGUECASE_SOUTHWEST_AREA<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SimpleData</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>JOIN_COUNT<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>SimpleData</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SimpleData</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>AREANAME<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>No. of Dengue Cases : 2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>SimpleData</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SimpleData</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>DETAIL<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>No. of Dengue Cases : 2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>SimpleData</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SimpleData</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>INC_CRC<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>902EDAE1119E0520<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>SimpleData</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SimpleData</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>FMEL_UPD_D<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>20180531113843<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>SimpleData</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>SchemaData</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ExtendedData</span><span class=\"token punctuation\">></span></span>\n...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Placemark</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>These <code class=\"language-text\">SimpleData</code> all had a specific name as an attribute and I noticed that all of the <code class=\"language-text\">Placemarks</code> would have the same set of <code class=\"language-text\">SimpleData</code> and all of them would be assigned to the same name attributes. So, I begun to think that there must be some declaration fo these names at the beginning or the end of the KML file that is associated with these name attributes, and sure enough, at the top, I found the next discovery, the <code class=\"language-text\">&lt;SimpleField&gt;&lt;/SimpleField&gt;</code> tag.</p>\n<p>Right at the top of the document, right after the <code class=\"language-text\">Document</code> tag, there are declarations for <code class=\"language-text\">SimpleField</code>s with their <code class=\"language-text\">displayName</code> being the associated name attributes that I had found earlier.</p>\n<p>So, from this brief analysis, I learnt 2 things:</p>\n<ol>\n<li>To extract the headers for the CSV file, I would need to find all those <code class=\"language-text\">SimpleField</code> tags and getting their <code class=\"language-text\">displayName</code>s</li>\n<li>To extract the contents, I would have to go through each <code class=\"language-text\">Placemark</code> and find the <code class=\"language-text\">ExtendedData</code> and extract the <code class=\"language-text\">SimpleData</code>s, associating each of the contents with one of the previously found headers.</li>\n</ol>\n<h3 id=\"process\" style=\"position:relative;\"><a href=\"#process\" aria-label=\"process permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Process</h3>\n<p>For this project, I decided on using Python to make the converter because it supports easy to use XML libraries like <a href=\"https://www.crummy.com/software/BeautifulSoup/bs4/doc/#\">BeautifulSoup</a> which made analysing the files much easier. Also, I was interested in GUI programming with Python, so I decided to use <a href=\"https://wiki.python.org/moin/TkInter\">TkInter</a> to make the GUI.</p>\n<p>I first had to make a base class <code class=\"language-text\">Converter</code> to ensure provide some base functionality in the event where I decide to extend the application to convert KML to other file formats. The base functionality included checking if the file could be convertible (whether it is even a compatible KML file) and getting the BeautifulSoup instance for that file. They were both made protected. </p>\n<p>Then, I worked on the first version of the converter, <code class=\"language-text\">CSVConverter</code>. It extended <code class=\"language-text\">Converter</code>, it would extract the headers and return them as a joined string, do the same for the rows of data, returning them in a CSV format. Then, the converter would create the needed destination folder which I used the <code class=\"language-text\">os</code> library to get the OS specific user folder. Then simply opening the file and uploading the newly generated data. This version of the converter had simply extracted the data as is, assuming that the order of the <code class=\"language-text\">SimpleData</code> fields would correspond to the <code class=\"language-text\">SimpleField</code> data at the top of the document. So, for instance, if the KML file had declared the <code class=\"language-text\">SimpleData</code> inverse to the original <code class=\"language-text\">SimpleField</code> declaration, the CSV file generated would be inversed too.</p>\n<p>This was a major problem, so I came up with the second version of the converter, <code class=\"language-text\">CSVConverter2</code>. This was meant to provide a manner of associating each of the <code class=\"language-text\">SimpleData</code> with the right <code class=\"language-text\">SimpleField</code> before saving it as a CSV file, so regardless of the ordering, the file would always be in the right order. I made use of an <code class=\"language-text\">OrderedDict</code>, but in retrospect, a normal dictionary would have worked. The keys would be the data that was declared in the <code class=\"language-text\">SimpleField</code> and for each of the key, it would have a list, to contain every single row. Then, when constructing thse data, I would link each of the data together to form the CSV file.</p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>I had a lot of fun analysing the KML file format, finding patterns and trying to come up with an optimal solution to extracting and converting a .kml file to a .csv file. Learning about TkInter as well as other libraries available to Python was also extremely fruitful and made me appreciate the simplicity that Python offers.</p>\n<p>If you would like to check out the GitHub repository, you can do so <a href=\"https://github.com/woojiahao/KMLConversionTool\">here</a>.</p>","frontmatter":{"title":"Breaking down KML files","date":"20 June 2018","description":"Analysing and creating a converter for KML files","tags":null},"fields":{"slug":"/blog/posts/2018-06-20-Learning-About-KML"}},"allMarkdownRemark":{"edges":[{"node":{"fields":{"slug":"/blog/posts/2018-04-14-Interning-at-Mightyaim"},"frontmatter":{"title":"Interning at MightyAim - the good, the bad and the ugly","published":true}}},{"node":{"fields":{"slug":"/blog/posts/2018-07-15-making-a-csv-to-database-tool"},"frontmatter":{"title":"Crafting a CSV to DB tool","published":true}}}]}},"pageContext":{"slug":"/blog/posts/2018-06-20-Learning-About-KML","next":"/blog/posts/2018-07-15-making-a-csv-to-database-tool","prev":"/blog/posts/2018-04-14-Interning-at-Mightyaim"}}}